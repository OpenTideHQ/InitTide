{
    "tvm": {
        "metadata": {
            "field": "tvm",
            "icon": "\u2623\ufe0f",
            "name": "Threat Vectors",
            "description": "Threat Vectors",
            "model": true
        },
        "entries": {
            "2743bf18-3b86-4721-bf3e-153dcda0b149": {
                "name": "Azure - Valid Credentials",
                "model": true,
                "tlp": "clear",
                "criticality": "High",
                "description": "This threat vector within the Initial Access phase represents a significant risk \nin Azure environments. This attack technique\u2014formally designated around adversaries \nacquiring and abusing legitimate authentication credentials to gain access to Azure \nresources or Azure Active Directory (AzureAD).\n\n### Example Attack Scenario\n\n- The attacker logs in directly to the Azure Portal or via CLI (e.g., `az login`) \nusing valid credentials.\n- Once inside, the attacker can enumerate resources, exfiltrate data, manipulate \nconfigurations, or leverage the account for further attacks, depending on the permissions \ngranted to the compromised account.\n- If privileged service principal credentials are obtained, the attacker can use \nsecrets or certificates to automate access and escalate privileges.\n\n### Attack Goals and Impact\n\n- **Primary Goals:**  - Establish initial access to Azure environments in a stealthy, low-noise manner   by using valid, non-malicious authentication flows.  - Access sensitive data, manipulate cloud resources, and potentially escalate   privileges or persist within the target environment.\n\n- **Impact:**  - Complete compromise of Azure resources accessible by the stolen account (files,   databases, VMs, identity services, etc.).  - Potential for privilege escalation if the account is eligible for higher roles   or Privileged Identity Management (PIM).  - Ability to create backdoors, perform lateral movement, and evade detection (since   all actions appear legitimate).  - Depending on account privileges, ransomware deployment, data exfiltration, and   broad access to organizational assets may occur.\n\n### Attack Flow and Methodology\n\n1. **Reconnaissance**  - Attackers gather information on users or service principals, identifying potential   targets through open-source intelligence, misconfigurations, or enumeration of   publicly accessible resources.\n\n2. **Credential Acquisition**  - Common methods: phishing (email/SMS/voice), brute-force/password spraying,   harvesting credentials from previous breaches, or exploiting cloud API/application   misconfigurations.  - Service principal secrets/certificates may be obtained from publicly accessible   repositories, misconfigured code, or automation scripts.\n\n3. **Authentication**  - Adversary logs into Azure Portal or invokes cloud APIs using the acquired credentials.  - For service principals: authentication occurs via CLI or programmatic access   using certificates/secrets.\n\n4. **Enumeration and Expansion**  - Mapping out resources, roles, permissions; searching for sensitive data or   additional high-value targets.  - Assessing role activation and privilege escalation opportunities (e.g., via   PIM or RBAC misconfigurations).\n\n5. **Execution of Attack Objectives**  - Data exfiltration, sabotage, account persistence (creating additional user   accounts or credentials), lateral movement to other resources, or exploitation   for financial gain.  - Actions are typically performed under the guise of the legitimate account to   avoid detection.\n\n6. **Persistence and Defense Evasion**  - Adversaries may create new accounts, modify access policies, or abuse automation   to ensure continued access.  - Use of valid credentials enables attackers to blend with legitimate user activity,   thus evading many traditional security detection systems.\n"
            },
            "bdc58fee-8da6-4fc9-8fbd-30f8fd156bc7": {
                "name": "Powershell with encoded payload passed to cmdline",
                "model": true,
                "tlp": "clear",
                "criticality": "Medium",
                "description": "When working with PowerShell, a threat actor can encode a command or script\nusing Base64 or other type of encoding and pass it as a parameter to the\ncommand line. This technique is useful for obfuscating sensitive\ninformation or executing complex commands. (ref [1])  \n\nOther possible examples for encoding with PowerShell commands: \n\nEncoding a Command with Base64\n\n1. Create a command as a string. \n\n```\n$command = 'dir \"C:\\Program Files\"'\n```\n\n2. Convert the command to Base64:\n\n```pwsh\n$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)\n$encodedCommand = [Convert]::ToBase64String($bytes)\n```\n\nNow you can run the encoded command using powershell.exe:\n\n```\npowershell.exe -encodedCommand $encodedCommand\n```\n\nIt's also possible to encode domain names, for example: \n\nPowershell input:\n\n```pwsh\n[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"'sample_domain.com'\"))\n```\n\nThreat actors also use PowerShell scripts for faster encoding process and result.  \n\nAn example of Powershell script (ref [2])  \n\n```pwsh\nparam(\n[Parameter()][Alias(\"un\")][string]$Username,\n[Parameter()][Alias(\"pw\")][string]$Password\n)\n\nWrite-Host \"Username: $Username\"\nWrite-Host \"Password: $Password\"\n```"
            }
        }
    },
    "cdm": {
        "metadata": {
            "field": "cdm",
            "icon": "\ud83d\udee1\ufe0f",
            "name": "Detection Models",
            "description": "Detection Models",
            "model": true
        },
        "entries": {
            "cf9c69a2-9317-4f0f-9506-fbeeb1c73ff0": {
                "name": "Powershell encoded payload to start new process",
                "model": true,
                "tlp": "clear",
                "criticality": "High",
                "description": "Adversaries use PowerShell to execute local scripts and execute remote resources \nafter retrieving them using multiple network protocols. They can also encode payloads \nusing the command line and load PowerShell into other processes.\n\nHere are some examples of encoded PowerShell payloads and how they can be detected:\n\n### Base64-Encoded Payload\n\n#### background\n\nA common technique is to encode the entire PowerShell script in Base64 and execute it using \nthe -encodedcommand switch.\n\nTo detect this, look for:\n- Execution of powershell.exe with encode arguments\n- The presence of base64 string in the command line\n\n#### detection strategies\n\nto detect base64encoded string, you may use REGEX and then you may have the \noption on the detection platform to decode the base64 encoded string to \nconfirm the actions done.  \n\nWhen focusing on specific keywords within the encoded string, a very good\napproach is to precompute the base64 encoded version of the keyword and \nsearch for that pattern in strings. To precompute the base64 string, 3 \nscenario have to be considered:\n- the keyword is at a boundary of a 3-character block\n- the keyword starts at second character of a 3-character block\n- the keyword starts at the third character of 3-character block\n\nMalicious payloads are often encoded and obfuscated, with PowerShell commands frequently \nused to download them from the internet. To detect encoded and downloadable command line \narguments, it is essential to examine PowerShell logs, such as Sysmon or Windows PowerShell logs, \nfor the presence of specific keywords like \"Net.WebClient,\" \"DownloadFile,\" \"Invoke-WebRequest,\" \n\"Invoke-Shellcode,\" \"http:,\" \"-enc,\" \"-encodedCommand,\" \"-e,\" \"-ec,\" \"-en,\" \"-encod,\" and \"-enco\".  \n\nAdditionally, you can visit the following page to access a PowerShell Watchlist that helps with detection. [4]  \n\nFor example, this CDM attemtps to detect the launch of a process \nusing the cmdlet \"Start-Process\". Preprocessing this keyword gives \nthe following search strings (without decoding base64 nor REGEX)\n\n| Keyword | offset | string (with leading _ or *) | search string |\n| --- | --- | --- | --- |\n| Start-Process | 0 | U3RhcnQtUHJvY2Vzcw== | U3RhcnQtUHJvY2Vz |\n| Start-Process | 1 | X1N0YXJ0LVByb2Nlc3M= / KlN0YXJ0LVByb2Nlc3M= | N0YXJ0LVByb2Nl |\n| Start-Process | 2 | X19TdGFydC1Qcm9jZXNz / KipTdGFydC1Qcm9jZXNz | TdGFydC1Qcm9jZXNz |    \n### Obfuscated Payload with Special Characters\n\nAdversaries may also obfuscate the PowerShell script using special characters.\n\nTo detect this, look for:\n- Execution of powershell.exe with the -nop, -w hidden, and -c arguments\n- High counts of obfuscation characters like `, `, and '\n\nUseful telemetry will include:\n\n- Windows Security Event ID 400: PowerShell command-line logging\n- Windows Security Event IDs 800 and 4103: Module loading and Add-Type logging\n- Windows Security Event ID 4688 : A new process has been created including process command-line\n- Sysmon Event IDs 1 and 7: Process creation and Image loaded\n"
            }
        }
    },
    "dom": {
        "metadata": {
            "field": "dom",
            "icon": "\ud83c\udfaf",
            "name": "Detection Objectives",
            "description": "Detection Objectives",
            "model": true
        },
        "entries": {
            "f4a8b3c2-7e5d-4f1a-bc8e-9d2a6e7c8f0b": {
                "name": "Detect Abuse of Valid Azure Credentials",
                "model": true,
                "tlp": "clear",
                "criticality": "Critical",
                "description": "Detect when adversaries abuse valid Azure AD/Entra ID credentials to gain \nunauthorized access to cloud resources. This detection objective focuses on \nidentifying anomalous authentication patterns, suspicious access behaviors, \nand privilege abuse that indicate compromised credentials are being used \nfor malicious purposes.\n\nAttackers obtain credentials through various means (phishing, password spraying, \ncredential leaks) and use them to authenticate legitimately to Azure services, \nmaking detection challenging as the authentication itself appears valid. This \nobjective aims to identify the contextual anomalies and behavioral indicators \nthat differentiate legitimate use from credential abuse.\n\nKey focus areas include:\n- Anomalous sign-in patterns (location, device, time, velocity)\n- Privilege escalation attempts post-authentication\n- Unusual resource access patterns\n- Service principal and application credential abuse\n- Cross-tenant authentication anomalies\n"
            },
            "12fb0e6a-a4e4-42d3-b77b-3c9c96f90f0b": {
                "name": "Detect Abuse of Valid Azure Credentials::Anomalous Azure AD Sign-In Patterns",
                "model": true,
                "tide.object.parent": "f4a8b3c2-7e5d-4f1a-bc8e-9d2a6e7c8f0b",
                "tlp": "clear",
                "criticality": "High",
                "description": "Detects authentication activities to Azure AD/Entra ID that deviate from \nestablished baseline patterns for user accounts. This includes monitoring \nfor impossible travel scenarios, sign-ins from unusual geographic locations, \nunfamiliar devices, anonymous IP addresses, or suspicious ISPs.\n\nKey detection indicators:\n- Sign-in from a geographic location where the user has never authenticated before\n- Impossible travel: authentication from two distant locations within an   unrealistic timeframe\n- Authentication from TOR exit nodes, VPN services, or anonymizing proxies\n- Sign-in from a device that doesn't match the user's typical device profile\n- Authentication outside normal business hours for privileged accounts\n- Multiple failed authentication attempts followed by a successful login\n- Sign-ins with legacy authentication protocols (bypassing MFA)\n\nParticular attention should be paid to privileged accounts (Global Administrators, \nSecurity Administrators, Application Administrators) as these represent high-value \ntargets for attackers.\n"
            },
            "d4d7e42b-3f9b-41c7-8dfb-ee7021ee806f": {
                "name": "Detect Abuse of Valid Azure Credentials::Service Principal Credential Abuse",
                "model": true,
                "tide.object.parent": "f4a8b3c2-7e5d-4f1a-bc8e-9d2a6e7c8f0b",
                "tlp": "clear",
                "criticality": "High",
                "description": "Detects suspicious activities involving Azure service principal credentials \n(client secrets, certificates). Service principals are non-human identities \nthat applications use to authenticate, making them prime targets for attackers \nseeking persistent, stealthy access to Azure resources.\n\nDetection focuses on:\n- Service principal authentication from unexpected IP addresses or geographic locations\n- Service principal used to access resources outside its typical scope\n- Rapid enumeration of resources or permissions by a service principal\n- Service principal credentials used after being added to an existing application\n- Authentication using service principal secrets that were recently created or modified\n- Service principal accessing multiple subscriptions or tenants (if not expected)\n- High volume of API calls from a service principal in a short time period\n- Service principal making privileged changes (role assignments, policy modifications)\n\nAttackers who compromise service principal credentials can maintain long-term \naccess while evading user-focused security controls like MFA. These credentials \nare often stored in code repositories, configuration files, or automation scripts \nwhere they can be harvested.\n"
            },
            "11686b3d-5f9d-4c1e-b3a8-4bae83653d24": {
                "name": "Detect Abuse of Valid Azure Credentials::Privilege Escalation After Initial Access",
                "model": true,
                "tide.object.parent": "f4a8b3c2-7e5d-4f1a-bc8e-9d2a6e7c8f0b",
                "tlp": "clear",
                "criticality": "Critical",
                "description": "Detects attempts to escalate privileges within Azure following successful \nauthentication with valid credentials. This signal identifies when an attacker, \nafter gaining initial access with compromised credentials, attempts to expand \ntheir privileges through role assignments, PIM activations, or exploitation \nof misconfigured permissions.\n\nKey detection patterns:\n- User account assigned to a privileged role (Global Admin, Security Admin, etc.)   shortly after a suspicious sign-in event\n- Activation of Privileged Identity Management (PIM) roles from unusual locations   or devices\n- User granted permissions to sensitive resources (Key Vaults, Storage Accounts)   that they've never accessed before\n- Addition of credentials to existing applications or service principals\n- Changes to Conditional Access policies that weaken security controls\n- Modification of MFA settings for privileged accounts\n- Creation of new service principals or applications with elevated permissions\n- Assignment of directory roles that allow further privilege escalation\n\nTemporal correlation is critical: privilege changes occurring within minutes \nto hours of anomalous authentication events represent high-confidence indicators \nof compromise. Attackers often move quickly to escalate privileges before \ndefenders can respond to initial access alerts.\n"
            },
            "353add53-6e14-47df-b65a-a591d2c6aacd": {
                "name": "Detect Abuse of Valid Azure Credentials::Suspicious Resource Enumeration and Access Patterns",
                "model": true,
                "tide.object.parent": "f4a8b3c2-7e5d-4f1a-bc8e-9d2a6e7c8f0b",
                "tlp": "clear",
                "criticality": "Medium",
                "description": "Detects unusual patterns of resource enumeration and access that indicate \nan attacker is exploring the Azure environment to identify high-value targets \nafter gaining access with valid credentials. This includes broad reconnaissance \nactivities across subscriptions, resource groups, and sensitive assets.\n\nDetection indicators:\n- Rapid succession of read operations across multiple Azure resource types   (VMs, storage accounts, databases, key vaults) within a short timeframe\n- User accessing resources they have never accessed historically\n- Enumeration of all subscriptions, resource groups, or management groups   accessible to the compromised account\n- PowerShell or Azure CLI commands used for systematic resource discovery   (Get-AzResource, az resource list, etc.)\n- Microsoft Graph API queries to enumerate users, groups, applications,   service principals, or role assignments\n- Access to sensitive resources (Key Vault secrets, storage account keys,   database connection strings) following initial authentication\n- Cross-subscription resource access patterns that deviate from normal behavior\n- Failed access attempts to resources followed by successful permission modifications\n\nAttackers performing post-compromise reconnaissance typically exhibit scanning \nbehaviors distinct from normal administrative activities: broader scope, higher \nvelocity, and less targeted access patterns. Correlation with earlier authentication \nanomalies significantly increases detection confidence.\n"
            },
            "cf9c69a2-9317-4f0f-9506-fbeeb1c73ff0": {
                "name": "Powershell encoded payload to start new process",
                "model": true,
                "tlp": "clear",
                "criticality": "High",
                "description": "Adversaries use PowerShell to execute local scripts and execute remote resources \nafter retrieving them using multiple network protocols. They can also encode payloads \nusing the command line and load PowerShell into other processes.\n\nHere are some examples of encoded PowerShell payloads and how they can be detected:\n\n### Base64-Encoded Payload\n\n#### background\n\nA common technique is to encode the entire PowerShell script in Base64 and execute it using \nthe -encodedcommand switch.\n\nTo detect this, look for:\n- Execution of powershell.exe with encode arguments\n- The presence of base64 string in the command line\n\n#### detection strategies\n\nto detect base64encoded string, you may use REGEX and then you may have the \noption on the detection platform to decode the base64 encoded string to \nconfirm the actions done.  \n\nWhen focusing on specific keywords within the encoded string, a very good\napproach is to precompute the base64 encoded version of the keyword and \nsearch for that pattern in strings. To precompute the base64 string, 3 \nscenario have to be considered:\n- the keyword is at a boundary of a 3-character block\n- the keyword starts at second character of a 3-character block\n- the keyword starts at the third character of 3-character block\n\nMalicious payloads are often encoded and obfuscated, with PowerShell commands frequently \nused to download them from the internet. To detect encoded and downloadable command line \narguments, it is essential to examine PowerShell logs, such as Sysmon or Windows PowerShell logs, \nfor the presence of specific keywords like \"Net.WebClient,\" \"DownloadFile,\" \"Invoke-WebRequest,\" \n\"Invoke-Shellcode,\" \"http:,\" \"-enc,\" \"-encodedCommand,\" \"-e,\" \"-ec,\" \"-en,\" \"-encod,\" and \"-enco\".  \n\nAdditionally, you can visit the following page to access a PowerShell Watchlist that helps with detection. [4]  \n\nFor example, this CDM attemtps to detect the launch of a process \nusing the cmdlet \"Start-Process\". Preprocessing this keyword gives \nthe following search strings (without decoding base64 nor REGEX)\n\n| Keyword | offset | string (with leading _ or *) | search string |\n| --- | --- | --- | --- |\n| Start-Process | 0 | U3RhcnQtUHJvY2Vzcw== | U3RhcnQtUHJvY2Vz |\n| Start-Process | 1 | X1N0YXJ0LVByb2Nlc3M= / KlN0YXJ0LVByb2Nlc3M= | N0YXJ0LVByb2Nl |\n| Start-Process | 2 | X19TdGFydC1Qcm9jZXNz / KipTdGFydC1Qcm9jZXNz | TdGFydC1Qcm9jZXNz |    \n### Obfuscated Payload with Special Characters\n\nAdversaries may also obfuscate the PowerShell script using special characters.\n\nTo detect this, look for:\n- Execution of powershell.exe with the -nop, -w hidden, and -c arguments\n- High counts of obfuscation characters like `, `, and '\n\nUseful telemetry will include:\n\n- Windows Security Event ID 400: PowerShell command-line logging\n- Windows Security Event IDs 800 and 4103: Module loading and Add-Type logging\n- Windows Security Event ID 4688 : A new process has been created including process command-line\n- Sysmon Event IDs 1 and 7: Process creation and Image loaded\n"
            }
        }
    },
    "bdr": {
        "metadata": {
            "field": "bdr",
            "icon": "\ud83c\udfdb\ufe0f",
            "name": "Business Requests",
            "description": "Business Requests",
            "model": true
        },
        "entries": {}
    },
    "mdr": {
        "metadata": {
            "field": "mdr",
            "icon": "\ud83d\udea8",
            "name": "Detection Rules",
            "description": "Detection Rules",
            "model": true
        },
        "entries": {}
    }
}