{
    "title": "OpenTide Visibility Configuration",
    "description": "Configuration specification for security visibility including log sources, assets, and external detectors in the TIDE framework",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "additionalProperties": false,
    "required": [
        "logsources"
    ],
    "properties": {
        "assets": {
            "type": "array",
            "title": "Assets",
            "description": "List of assets that generate logs in the environment",
            "items": {
                "type": "object",
                "title": "Asset",
                "description": "Defines a business or technical asset that generates logs",
                "required": [
                    "name",
                    "description",
                    "criticality"
                ],
                "properties": {
                    "name": {
                        "title": "Asset Name",
                        "type": "string",
                        "description": "Unique identifier for the asset, typically in format 'Organization::AssetName'"
                    },
                    "description": {
                        "title": "Asset Description",
                        "type": "string",
                        "description": "Detailed description of what the asset does or represents"
                    },
                    "criticality": {
                        "title": "Asset Criticality",
                        "type": "string",
                        "description": "Business criticality level indicating the asset's importance and potential impact",
                        "oneOf": [
                            {
                                "const": "Crown Jewel",
                                "title": "Crown Jewel",
                                "description": "### Crown Jewel\nSystems or assets that are critical to both business operations and security posture.\n\n**Business Impact:**\n- Immediate and severe impact on core operations\n- No acceptable downtime\n- Direct financial/reputational damage\n\n**Security Impact:**\n- Breach could lead to organization-wide compromise\n- High-value target for advanced threats\n- Subject to regulatory/compliance requirements\n- Could impact multiple downstream systems\n\n*Examples:* Active Directory infrastructure, primary authentication systems, key management systems, security orchestration platforms\n"
                            },
                            {
                                "const": "High Value",
                                "title": "High Value",
                                "description": "### High Value\nSystems or assets with significant business value and security implications.\n\n**Business Impact:**\n- Major disruption to business functions\n- Limited downtime tolerance (hours)\n- Significant operational impact\n\n**Security Impact:**\n- Potential for lateral movement\n- Contains sensitive data/credentials\n- Security control dependencies\n- Incident response capabilities affected\n\n*Examples:* SIEM systems, EDR infrastructure, privileged access management systems, critical data stores\n"
                            },
                            {
                                "const": "Operational",
                                "title": "Operational",
                                "description": "### Operational\nSystems or assets essential for day-to-day security operations.\n\n**Business Impact:**\n- Moderate business disruption\n- Defined recovery time objectives\n- Limited scope of impact\n\n**Security Impact:**\n- Security monitoring degradation\n- Detection capability reduction\n- Potential visibility gaps\n- Limited exposure of sensitive data\n\n*Examples:* Log collection systems, network monitoring tools, vulnerability scanners\n"
                            },
                            {
                                "const": "Supporting",
                                "title": "Supporting",
                                "description": "### Supporting\nSystems or assets that enhance security posture but aren't primary controls.\n\n**Business Impact:**\n- Minor business disruption\n- Extended recovery time acceptable\n- Isolated impact\n\n**Security Impact:**\n- Redundant security controls\n- Non-critical security data\n- Limited attack surface\n- Supplementary monitoring\n\n*Examples:* Secondary log sources, backup monitoring systems, test security tools\n"
                            },
                            {
                                "const": "Non Essential",
                                "title": "Non Essential",
                                "description": "### Non-Essential\nSystems or assets with minimal security significance.\n\n**Business Impact:**\n- Minimal operational impact\n- No direct business disruption\n- Fully redundant systems\n\n**Security Impact:**\n- No sensitive data exposure\n- Isolated from critical systems\n- No direct security control function\n- Low risk if compromised\n\n*Examples:* Development test systems, isolated lab environments, non-production monitoring tools\n"
                            }
                        ]
                    },
                    "custom_details": {
                        "title": "Custom Details",
                        "type": "object",
                        "description": "Optional open-ended dictionary for asset-specific metadata with custom key-value pairs",
                        "additionalProperties": true
                    }
                }
            }
        },
        "detectors": {
            "type": "array",
            "title": "External Detectors",
            "description": "List of external detection capabilities from third-party tools and platforms",
            "items": {
                "type": "object",
                "title": "External Detector",
                "description": "Defines an external detection capability (e.g., GuardDuty findings, vendor alerts)",
                "required": [
                    "name",
                    "description"
                ],
                "properties": {
                    "name": {
                        "title": "Detector Name",
                        "type": "string",
                        "description": "Name of the external detector or finding"
                    },
                    "description": {
                        "title": "Detector Description",
                        "type": "string",
                        "description": "Detailed description of what this detector identifies or monitors"
                    },
                    "references": {
                        "title": "References",
                        "type": "array",
                        "description": "List of URLs to documentation or relevant resources about this detector",
                        "items": {
                            "title": "Reference URL",
                            "type": "string"
                        }
                    },
                    "assets": {
                        "title": "Associated Assets",
                        "type": "array",
                        "description": "References to asset names that this detector monitors, MUST correspond to assets entered under the [[assets]] section",
                        "items": {
                            "title": "Asset Reference",
                            "type": "string"
                        }
                    }
                }
            }
        },
        "logsources": {
            "type": "array",
            "title": "Log Sources",
            "description": "List of available log sources across all detection systems",
            "items": {
                "type": "object",
                "title": "Log Source",
                "description": "Defines a specific log source that can be queried for detection purposes",
                "required": [
                    "name",
                    "description",
                    "system"
                ],
                "properties": {
                    "name": {
                        "title": "Log Source Name",
                        "type": "string",
                        "description": "Human-readable name of the log source"
                    },
                    "description": {
                        "title": "Log Source Description",
                        "type": "string",
                        "description": "Detailed description of what kind of data this log source provides"
                    },
                    "system": {
                        "title": "Detection System",
                        "type": "string",
                        "description": "The system where this log source can be queried",
                        "enum": [
                            "splunk",
                            "defender_for_endpoint",
                            "sentinel",
                            "sentinel_one",
                            "crowdstrike",
                            "carbon_black_cloud"
                        ]
                    },
                    "tenants": {
                        "title": "Tenants",
                        "type": "array",
                        "description": "List of environments/tenants where this log source is available",
                        "items": {
                            "title": "Tenant",
                            "type": "string"
                        }
                    },
                    "references": {
                        "title": "References",
                        "type": "array",
                        "description": "List of URLs to documentation or relevant resources about this log source",
                        "items": {
                            "title": "Reference URL",
                            "type": "string"
                        }
                    },
                    "assets": {
                        "title": "Associated Assets",
                        "type": "array",
                        "description": "References to asset names that generate these logs, MUST correspond to assets entered under the [[assets]] section",
                        "items": {
                            "title": "Asset Reference",
                            "type": "string"
                        }
                    }
                }
            }
        }
    }
}